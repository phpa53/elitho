<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:component xmlns="http://www.w3.org/1999/xhtml"
	xmlns:c="jakarta.tags.core"
	xmlns:cc="jakarta.faces.composite"
	xmlns:f="jakarta.faces.core"
	xmlns:faces="jakarta.faces"
	xmlns:fn="jakarta.tags.functions"
	xmlns:h="jakarta.faces.html"
	xmlns:p="http://primefaces.org/ui"
	xmlns:pass="jakarta.faces.passthrough"
	xmlns:ui="jakarta.faces.facelets">
	
	<h:form id="elithorecipeexportForm" prependId="false">
		
		<p:growl id="elithorecipeexportGrowl" showDetail="true" life="3000"/>
		
		<p:confirmDialog global="true" showEffect="fade" hideEffect="fade">
	        <p:commandButton value="Yes"
				type="button"
				styleClass="ui-confirmdialog-yes ui-button-danger"
				icon="pi pi-check"/>
	        <p:commandButton value="No"
				type="button"
				styleClass="ui-confirmdialog-no ui-button-secondary"
				icon="pi pi-times"/>
		</p:confirmDialog>
		
		<p:dataTable id="elithorecipeexportDT"
        	widgetVar="elithorecipeexportDTW"
        	var="item"
        	value="#{eLithoRecipeExportBean.items}"
        	rowKey="#{item.getKey()}"
			scrollable="true"
			scrollHeight="800"
			lazy="false"
			sortMode="multiple"
			filterMode="advanced"
			virtualScroll="false"
			tableStyle="width:overflow"
			resizableColumns="true"
			resizeMode="expand"
			draggableColumns="true"
			size="small"
			editable="true"
			editInitEvent="click"
			editMode="cell"
            selectionMode="multiple"
            selection="#{eLithoRecipeExportBean.selectedItems}"
            selectionPageOnly="false"
            disabledSelection="false"
			stripedRows="true"
			disabledTextSelection="false"
			cache="true"
        	showGridlines="true">
        	
        	<f:facet name="header">
        		<div style="display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap;
		            margin-top:5px;margin-bottom:5px;">
	            	<span style="margin-top:-5px;">
		        		<p:commandButton value="Apply"
			               	actionListener="#{eLithoRecipeExportBean.apply}"
			                update="elithorecipeexportDT elithoTabView:elithorecipeexportGrowl"
							oncomplete="resizeElithoRecipeExportTable();"/>
	                    <p:commandButton id="elithorecipeexportNewCB"
	                    	title="New"
	                    	icon="pi pi-plus"
		                    styleClass="ml-2 ui-button-success"
		                    rendered="#{facesContext.externalContext.isUserInRole('elitho-write')}"
		                    actionListener="#{eLithoRecipeExportBean.add()}"
		                    update="elithorecipeexportDT elithoTabView:elithorecipeexportGrowl"
		                    oncomplete="resizeElithoRecipeExportTable();"/>
	                    <p:commandButton id="elithorecipeexportCopyCB"
	                    	title="Copy"
	                    	icon="pi pi-copy"
		                    styleClass="ml-2 ui-button-success"
		                    rendered="#{facesContext.externalContext.isUserInRole('elitho-write')}"
		                    disabled="#{eLithoRecipeExportBean.copyDisabled()}"
		                    actionListener="#{eLithoRecipeExportBean.copy()}"
		                    update="elithorecipeexportDT elithoTabView:elithorecipeexportGrowl"
		                    oncomplete="resizeElithoRecipeExportTable();"/>
	                    <p:commandButton id="elithorecipeexportDeleteCB"
	                    	title="Delete"
	                    	value="#{eLithoRecipeExportBean.getDeleteLabel()}"
		                	icon="pi pi-trash"
		                	escape="false"
		                    styleClass="ml-2 ui-button-danger"
		                    rendered="#{facesContext.externalContext.isUserInRole('elitho-write')}"
		                    disabled="#{empty eLithoRecipeExportBean.selectedItems}"
		                    actionListener="#{eLithoRecipeExportBean.delete()}"
		                    update="@this elithorecipeexportDT elithoTabView:elithorecipeexportGrowl"
		                    oncomplete="resizeElithoRecipeExportTable();">
		                    <p:confirm header="Confirmation"
				            	message="Are you sure you want to delete this item?"
				            	icon="pi pi-exclamation-triangle"/>
		                </p:commandButton>
	                    <p:commandButton id="elithorecipeexportSaveCB"
	                    	title="Save"
		                	icon="pi pi-save"
		                    styleClass="ml-2 ui-button-info"
		                    rendered="#{facesContext.externalContext.isUserInRole('elitho-write')}"
		                    disabled="#{eLithoRecipeExportBean.saveDisabled()}"
		                    actionListener="#{eLithoRecipeExportBean.save()}"
		                    update="elithorecipeexportDT elithoTabView:elithorecipeexportGrowl"
		                    oncomplete="resizeElithoRecipeExportTable();"/>
	                    <p:commandButton id="elithorecipeexportDiscardCB"
	                    	title="Discard"
		                	icon="pi pi-undo"
		                    styleClass="ml-2 ui-button-info"
		                    rendered="#{facesContext.externalContext.isUserInRole('elitho-write')}"
		                    disabled="#{not eLithoRecipeExportBean.anyItemChanged}"
		                    actionListener="#{eLithoRecipeExportBean.discard()}"
		                    update="elithorecipeexportDT elithoTabView:elithorecipeexportGrowl"
		                    oncomplete="resizeElithoRecipeExportTable();"/>
		               	<p:commandButton icon="pi pi-sort-alt-slash"
		               		title="Reset Table"
		               		styleClass="ml-2 ui-button-secondary"
		                    rendered="#{facesContext.externalContext.isUserInRole('elitho-write')}"
		               		action="#{eLithoRecipeExportBean.resetTable}"
		               		update="elithorecipeexportDT"
		                    oncomplete="resizeElithoRecipeExportTable();"/>
		                <p:tooltip for="@next" value="Column to expand"/>
		                <p:commandButton icon="pi pi-angle-down"
		                    styleClass="ml-2"
		                    title="Expand All"
		                    type="button"
                 			onclick="expandAllRows('elithorecipeexportDTW');"/>
		                <p:commandButton icon="pi pi-angle-right"
		                    styleClass="ml-2"
		                    title="Collapse All"
		                	type="button"
                 			onclick="collapseAllRows('elithorecipeexportDTW');"/>
						<p:outputLabel value="#{eLithoRecipeExportBean.numberOfChanges} row(s) changed"
							style="font-weight:bold;color:orange;"
							styleClass="ml-2"
		               		rendered="#{eLithoRecipeExportBean.numberOfChanges > 0}"/>
						<p:outputLabel value="#{eLithoRecipeExportBean.numberOfDeletes} row(s) deleted"
							style="font-weight:bold;color:orange;"
							styleClass="ml-2"
		               		rendered="#{eLithoRecipeExportBean.numberOfDeletes > 0}"/>
					</span>
				</div>
        	</f:facet>
        	
        	<p:ajax event="rowSelect" update="elithorecipeexportCopyCB elithorecipeexportDeleteCB"/>
            <p:ajax event="rowUnselect" update="elithorecipeexportCopyCB elithorecipeexportDeleteCB"/>
            <p:ajax event="rowSelectCheckbox" update="elithorecipeexportCopyCB elithorecipeexportDeleteCB"/>
            <p:ajax event="rowUnselectCheckbox" update="elithorecipeexportCopyCB elithorecipeexportDeleteCB"/>
            <p:ajax event="toggleSelect" update="elithorecipeexportCopyCB elithorecipeexportDeleteCB"/>
        	
        	<p:column style="width:10px;" styleClass="#{item.toBeFilled() ? 'cell-to-be-filled' : ''}"/>
        	<p:column headerText="Recipe"
        		title="Recipe Name"
        		style="width:80px;text-align:center;color:#{item.getAttributeColor()};"
        		styleClass="#{item.hasAttributeChanged('recipeName') ? 'cell-changed' : ''}"
				sortBy="#{item.recipeName}"
            	filterBy="#{item.recipeName}">
            	<p:cellEditor>
                    <f:facet name="output">
                		<h:outputText value="#{item.recipeName}"/>
                    </f:facet>
                    <f:facet name="input">
                        <p:inputText value="#{item.recipeName}"
                        	style="width:100%"
                        	maxlength="100"
                        	immediate="true"
                        	valueChangeListener="#{eLithoRecipeExportBean.valueChanged}"
                        	onkeypress="if (event.keyCode == 13) {e.preventDefault();this.onblur();return false;}">
                        	<f:attribute name="item" value="#{item}"/>
                        	<f:attribute name="attribute" value="recipeName"/>
                        	<p:ajax event="blur"
	                       		listener="#{eLithoRecipeExportBean.checkKeyUniqueness()}"
                        		process="@this"
		                    	update="elithorecipeexportDT elithoTabView:elithorecipeexportGrowl"
                        		onstart="saveElithoRecipeExportScrollPos();"
		                    	oncomplete="resizeElithoRecipeExportTable();
		                    		setElithoRecipeExportScrollPos();"/>
                        </p:inputText>
                    </f:facet>
                </p:cellEditor>
			</p:column>
			
			
			<p:column headerText="Mode"
				title="Export Mode"
        		style="width:120px;text-align:center;color:#{item.getAttributeColor()};"
        		styleClass="#{item.hasAttributeChanged('exportMode') ? 'cell-changed' : ''}"
				sortBy="#{item.exportMode}"
            	filterBy="#{item.exportMode}">
            	<p:cellEditor>
                    <f:facet name="output">
                		<h:outputText value="#{item.exportMode}"/>
                    </f:facet>
                    <f:facet name="input">
                    	<p:inputText value="#{item.exportMode}"
	                       	style="width:100%"
	                       	maxlength="100"
	                       	immediate="true"
	                       	valueChangeListener="#{eLithoRecipeExportBean.valueChanged}"
	                       	onkeypress="if (event.keyCode == 13) {e.preventDefault();this.onblur();return false;}">
	                       	<f:attribute name="item" value="#{item}"/>
	                       	<f:attribute name="attribute" value="exportMode"/>
	                       	<p:ajax event="blur"
	                       		listener="#{eLithoRecipeExportBean.checkKeyUniqueness()}"
	                       		process="@this"
                        		update="elithorecipeexportDT elithoTabView:elithorecipeexportGrowl"
                        		onstart="saveElithoRecipeExportScrollPos();"
		                    	oncomplete="resizeElithoRecipeExportTable();setElithoRecipeExportScrollPos();"/>
                       </p:inputText>
                    </f:facet>
                </p:cellEditor>
			</p:column>
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			<ui:remove>
			<p:column headerText="Created"
        		style="width:130px;text-align:center;"
				sortBy="#{item.createdDate}"
            	filterBy="#{item.createdDate}">
                <h:outputText value="#{item.createdDate}" rendered="#{item.isCreatedDateValid()}"/>
            </p:column>
			<p:column headerText="Created By"
        		style="width:130px;text-align:center;"
				sortBy="#{item.createdBy}"
            	filterBy="#{item.createdBy}">
                <h:outputText value="#{item.createdBy}"/>
            </p:column>
			<p:column headerText="Last Modified"
        		style="width:130px;text-align:center;"
				sortBy="#{item.lastModifiedDate}"
            	filterBy="#{item.createdDate}">
                <h:outputText value="#{item.lastModifiedDate}" rendered="#{item.isLastModifiedDateValid()}"/>
            </p:column>
			<p:column headerText="Last Modified By"
        		style="width:130px;text-align:center;"
				sortBy="#{item.lastModifiedBy}"
            	filterBy="#{item.lastModifiedBy}">
                <h:outputText value="#{item.lastModifiedBy}"/>
            </p:column>
            </ui:remove>
			<p:column displayPriority="99"/>
	        	
		</p:dataTable>
		
	</h:form>
	
</ui:component>