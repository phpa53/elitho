<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:c="jakarta.tags.core"
	xmlns:cc="jakarta.faces.composite"
	xmlns:f="jakarta.faces.core"
	xmlns:faces="jakarta.faces"
	xmlns:fn="jakarta.tags.functions"
	xmlns:h="jakarta.faces.html"
	xmlns:p="http://primefaces.org/ui"
	xmlns:pass="jakarta.faces.passthrough"
	xmlns:ui="jakarta.faces.facelets">

<h:head>
   	<f:facet name="first">
		<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
		<meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
	</f:facet>
	<title>#{lotDetailsBean.lotId}</title>
	<h:outputStylesheet library="css" name="elitho.css"/>
	<h:outputStylesheet library="css" name="primeflex.min.css"/>
	<h:outputScript library="js" name="elitho.js"/>
</h:head>

<h:body>

	<h:form>
        <p:outputPanel id="topBanner"
	        styleClass="top-banner"
	        style="background-image: url('#{resource['images/theme.jpg']}');">
	        <h:panelGroup layout="block" styleClass="banner-left">
		        <p:tooltip for="@next" value="Go to Home page" showEffect="fade" hideEffect="fade" position="bottom"/>
	        	<p:link id="fsmTopHomeLink"
	        		value="DEEPLITHO"
	            	styleClass="banner-left deeplitho-shadow"
	            	style="text-decoration:none"
	        		href="#{topBean.getHomeUrl()}"/>
	        	<h:outputText value="INTEGRATION"
	        		style="font-size:30px;font-weight:bold;color:chartreuse;margin-left:10px;margin-top:5px;"
	        		rendered="#{topBean.appEnv eq 'int'}"/>
	        </h:panelGroup>
	        <h:panelGroup layout="block" styleClass="banner-center">
	            <h:outputText value="#{topBean.appLabel}"/>
	        </h:panelGroup>
	        <h:panelGroup layout="block" styleClass="banner-right">
	        	<p:tooltip for="@next"
	        		value="Manage your acoount"
	        		showEffect="fade"
	        		hideEffect="fade"
	        		position="bottom"/>
	        	<div>
	        		<span>
		        	<p:link id="fsmTopUsernameLink"
		        		style="color:white;"
		        		value="Logged in as: #{topBean.userName}" 
		        		href="#{topBean.keycloakUrl}/../realms/deeplitho/account"/>
			        	<br/>
			        	<h:outputText value="Version #{topBean.appVersion}"
			        		style="color:white;font-size:12px;font-style:italic;"/>
		        	</span>
	        	</div>
	        </h:panelGroup>
	    </p:outputPanel>
    </h:form>

	<h:form id="lotDetailsForm">
        
        <p:panelGrid id="lotDetailsPG" styleClass="lotdetails-grid" columns="5" layout="tabular">
        	<f:facet name="header">
        		<p:tooltip for="@next" value="Mode"/>
        		<p:selectOneButton id="lotdetailsmodeCB" value="#{lotDetailsBean.mode}" styleClass="ml-1">
		            <f:selectItem itemLabel="Lot" itemValue="lot"/>
		            <f:selectItem itemLabel="Cluster" itemValue="cluster"/>
		            <p:ajax event="change"
		            	listener="#{lotDetailsBean.modeChanged}"
		            	update="lotDetailsPG lotDetailsPanel"/>
		        </p:selectOneButton>
        		<p:tooltip for="@next" value="Scope"/>
        		<p:selectOneButton id="lotdetailsscopeCB" value="#{lotDetailsBean.scope}" styleClass="ml-1">
		            <f:selectItem itemLabel="Wafer" itemValue="wafer"/>
		            <f:selectItem itemLabel="Chuck" itemValue="chuck"/>
		            <p:ajax event="change"
		            	listener="#{lotDetailsBean.scopeChanged}"
		            		update="lotDetailsPG lotDetailsPanel"/>
		        </p:selectOneButton>
		        <p:commandButton id="lotdetailsfirstCB"
		        	icon="pi pi-angle-double-left"
                	title="First"
                	styleClass="ml-1"
                	disabled="#{lotDetailsBeanfirstDisabled}"
                	actionListener="#{lotDetailsBean.first()}"
                	update="@this lotDetailsPanel lotdetailsindexOL
                		lotdetailspreviousCB lotdetailsnextCB lotdetailslastCB"/>
		        <p:commandButton id="lotdetailspreviousCB"
		        	icon="pi pi-angle-left"
                	title="Previous"
                	styleClass="ml-1"
                	disabled="#{lotDetailsBean.previousDisabled}"
                	actionListener="#{lotDetailsBean.previous()}"
                	update="@this lotDetailsPanel lotdetailsindexOL
                		lotdetailsfirstCB lotdetailsnextCB lotdetailslastCB"/>
                <p:outputLabel id="lotdetailsindexOL" value="#{lotDetailsBean.getIndexLabel()}"
                	style="color:blue;font-size:12;" styleClass="ml-1"/>
		        <p:commandButton id="lotdetailsnextCB"
		        	icon="pi pi-angle-right"
                	title="Next"
                	styleClass="ml-1"
                	disabled="#{lotDetailsBean.nextDisabled}"
                	actionListener="#{lotDetailsBean.next()}"
                	update="@this lotDetailsPanel lotdetailsindexOL
                		lotdetailsfirstCB lotdetailspreviousCB lotdetailslastCB"/>
		        <p:commandButton id="lotdetailslastCB"
		        	icon="pi pi-angle-double-right"
                	title="Next"
                	styleClass="ml-1"
                	disabled="#{lotDetailsBean.lastDisabled}"
                	actionListener="#{lotDetailsBean.last()}"
                	update="@this lotDetailsPanel lotdetailsindexOL
                		lotdetailsfirstCB lotdetailspreviousCB lotdetailsnextCB"/>
        	</f:facet>
        	<p:row rendered="#{not empty LotDetailsBean.row0}">
        		<p:columns value="#{LotDetailsBean.row0}" var="col">
        		</p:columns>
        	</p:row>
        	<p:row rendered="#{not empty LotDetailsBean.row1}">
        		<p:columns value="#{LotDetailsBean.row1}" var="col">
        		</p:columns>
        	</p:row>
        	<p:row rendered="#{not empty LotDetailsBean.row2}">
        		<p:columns value="#{LotDetailsBean.row2}" var="col">
        		</p:columns>
        	</p:row>
        	<p:row rendered="#{not empty LotDetailsBean.row3}">
        		<p:columns value="#{LotDetailsBean.row3}" var="col">
        		</p:columns>
        	</p:row>
        	<p:row rendered="#{not empty LotDetailsBean.row4}">
        		<p:columns value="#{LotDetailsBean.row4}" var="col">
        		</p:columns>
        	</p:row>
        </p:panelGrid>
        
        <p:panel id="lotDetailsPanel">
        	<div style="display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap;
		    	margin-top:5px;">
				<span style="margin-top:-5px;">
					<p:outputLabel value="#{lotDetailsBean.lot.lotId}"
						styleClass="ml-2 font-bold"
						rendered="#{lotDetailsBean.mode.equals('lot')}"/>
					<p:outputLabel value="#{lotDetailsBean.lot.cluster}"
						styleClass="ml-2"
						rendered="#{lotDetailsBean.mode.equals('lot')}"/>
					<p:outputLabel value="#{lotDetailsBean.lot.cluster}"
						styleClass="ml-2 font-bold"
						rendered="#{lotDetailsBean.mode.equals('cluster')}"/>
					<p:outputLabel value="#{lotDetailsBean.lot.lotId}"
						styleClass="ml-2 font-bold"
						style="color:blueviolet"
						rendered="#{lotDetailsBean.mode.equals('cluster')}"/>
					<p:outputLabel value="#{lotDetailsBean.lot.getFormattedStart()}"
						styleClass="ml-2 font-bold"
						style="color:blueviolet"/>
					<p:outputLabel value="#{lotDetailsBean.lot.techno}"
						styleClass="ml-2"/>
					<p:outputLabel value="#{lotDetailsBean.lot.maskset}"
						styleClass="ml-2"/>
					<p:outputLabel value="#{lotDetailsBean.lot.layer}"
						styleClass="ml-2 font-bold"
						style="color:blueviolet"
						rendered="#{lotDetailsBean.mode.equals('lot')}"/>
					<p:outputLabel value="#{lotDetailsBean.lot.layer}"
						styleClass="ml-2"
						rendered="#{lotDetailsBean.mode.equals('cluster')}"/>
				</span>
                <span>
                	<p:panel>
                		<p:graphicImage value="#{lotDetailsBean.getWaferImage('W01')}"
                			style="width:350px;height:300px;"
                			rendered="#{lotDetailsBean.isWaferValid('W01')}"/>
                		<p:graphicImage value="#{lotDetailsBean.getWaferImage('W02')}"
                			style="width:350px;height:300px;"
                			rendered="#{lotDetailsBean.isWaferValid('W02')}"/>
                	</p:panel>
                </span>
			</div>
        </p:panel>
        
        
        
        
        
	    <p:panel header="Detection wafers" style="margin:1rem;" rendered="false">
	        <p:dataGrid value="#{lotDetailsBean.waferImages}"
	        	var="img"
                columns="5"
                styleClass="image-grid"
                layout="grid"
                paginator="false">
	            <p:panel styleClass="image-cell" style="text-align:center;">
	                <p:graphicImage value="#{img}" styleClass="image"/>
	            </p:panel>
	        </p:dataGrid>
	    </p:panel>
	    
	</h:form>
    
</h:body>
</html>
